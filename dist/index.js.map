{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { createSelector } from 'reselect'\nimport createSagaMiddleware from 'redux-saga'\nimport { applyMiddleware, createStore, compose } from 'redux'\nimport thunk from 'redux-thunk'\n\nexport const createTypes = type => ({\n  START: `${type}/START`,\n  RESET: `${type}/RESET`,\n  FINISH: `${type}/FINISH`,\n  ERROR: `${type}/ERROR`,\n})\n\nexport const createActionCreators = type => {\n  const { START, RESET, FINISH, ERROR } = createTypes(type)\n\n  return {\n    start: () => ({ type: START }),\n    reset: () => ({ type: RESET }),\n    finish: payload => ({ type: FINISH, payload }),\n    error: error => ({\n      type: ERROR,\n      error: (error && error.message) || 'Something went wrong',\n    }),\n  }\n}\n\nconst INITIAL_STATE = {\n  isLoading: true,\n  error: null,\n  payload: null,\n}\n\nexport const createReducer = (type, initialState = INITIAL_STATE) => (\n  state,\n  action = {},\n) => {\n  const { START, FINISH, ERROR, RESET } = createTypes(type)\n\n  switch (action.type) {\n    case START:\n      return {\n        isLoading: true,\n        error: null,\n        payload: initialState.payload,\n      }\n\n    case FINISH:\n      return {\n        isLoading: false,\n        error: null,\n        payload: action.payload,\n      }\n\n    case ERROR:\n      return {\n        isLoading: false,\n        error: action.error,\n        payload: initialState.payload,\n      }\n\n    case RESET:\n      return initialState\n\n    default:\n      return state || initialState\n  }\n}\n\nexport const createSelectors = (type, selector = {}) => {\n  const allSelector = createSelector(\n    state => state[type] || state,\n    root => root,\n  )\n  const payloadSelector = createSelector(\n    allSelector,\n    root => root.payload,\n  )\n\n  return {\n    ...selector,\n    getAll: allSelector,\n    getIsLoading: createSelector(\n      allSelector,\n      root => root.isLoading,\n    ),\n    getPayload: payloadSelector,\n    getPayloadData: createSelector(\n      payloadSelector,\n      payload => (payload && payload.data ? payload.data : null),\n    ),\n    getError: createSelector(\n      allSelector,\n      root => root.error,\n    ),\n  }\n}\n\nexport const createDuck = (options = {}) => {\n  const duck = {\n    type: options.type,\n    action: createActionCreators(options.type),\n    reducer: createReducer(options.type, options.initialState),\n    selector: createSelectors(options.type, options.selector),\n  }\n\n  const getAsyncAction = fn => (\n    props,\n    callback = duck.action.finish,\n  ) => async dispatch => {\n    dispatch(duck.action.start())\n\n    return fn(props)\n      .then(payload => {\n        if (callback) dispatch(callback(payload))\n        return payload\n      })\n      .catch(error => dispatch(duck.action.error(error)))\n  }\n\n  Object.entries(options.action || {}).map(\n    ([name, fn]) => (duck.action[name] = getAsyncAction(fn)),\n  )\n\n  if (options.getSelectors) {\n    duck.selector = {\n      ...duck.selector,\n      ...options.getSelectors(duck.selector),\n    }\n  }\n\n  return duck\n}\n\nexport const createEasyStore = ({\n  reducer = state => state,\n  middlewares = [],\n  saga,\n  name,\n}) => {\n  const composeEnhancers =\n    typeof window === 'object' && window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__\n      ? window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({\n          name,\n          serialize: true,\n        })\n      : compose\n\n  const sagaMiddleware = saga && createSagaMiddleware()\n\n  const allMiddlewares = [thunk, ...middlewares]\n\n  if (sagaMiddleware) allMiddlewares.push(sagaMiddleware)\n\n  const store = createStore(\n    reducer,\n    composeEnhancers(applyMiddleware(...allMiddlewares)),\n  )\n\n  if (sagaMiddleware) sagaMiddleware.run(saga)\n\n  return store\n}\n"],"names":["createTypes","type","START","RESET","FINISH","ERROR","createActionCreators","start","reset","finish","payload","error","message","INITIAL_STATE","isLoading","createReducer","initialState","state","action","createSelectors","selector","allSelector","createSelector","root","payloadSelector","getAll","getIsLoading","getPayload","getPayloadData","data","getError","createDuck","options","duck","reducer","getAsyncAction","fn","props","callback","dispatch","then","catch","Object","entries","map","name","getSelectors","createEasyStore","middlewares","saga","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","serialize","compose","sagaMiddleware","createSagaMiddleware","allMiddlewares","thunk","push","store","createStore","applyMiddleware","run"],"mappings":"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"}